import{al as K,aC as Q,t as T,Z as Y,c as d,d as v,aa as E,G as _,$ as U,j as V,I as k,T as z,e as $,ab as Z,Y as H,ak as J,a as W,K as M,a$ as R,L,r as j,M as g,g as a,f as l,N as S,O as I,b0 as X,P,l as ee,m as ae,E as le,n as O,Q as te,_ as oe}from"./index-dd5480ba.js";import{E as se,a as ne}from"./el-col-61c74ea7.js";import{a as de,E as re}from"./el-table-column-af935453.js";import{E as ue,a as me}from"./el-select-52d117f3.js";import{b as ie}from"./api-714c1c1c.js";import{v as B,L as F}from"./directive-a9448ffa.js";import"./index-63153d31.js";const pe=K({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:Q([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),ce=T({name:"ElCard"}),fe=T({...ce,props:pe,setup(p){const m=Y("card");return(s,b)=>(d(),v("div",{class:E([_(m).b(),_(m).is(`${s.shadow}-shadow`)])},[s.$slots.header||s.header?(d(),v("div",{key:0,class:E(_(m).e("header"))},[U(s.$slots,"header",{},()=>[V(k(s.header),1)])],2)):z("v-if",!0),$("div",{class:E([_(m).e("body"),s.bodyClass]),style:Z(s.bodyStyle)},[U(s.$slots,"default")],6),s.$slots.footer||s.footer?(d(),v("div",{key:1,class:E(_(m).e("footer"))},[U(s.$slots,"footer",{},()=>[V(k(s.footer),1)])],2)):z("v-if",!0)],2))}});var _e=H(fe,[["__file","card.vue"]]);const ve=J(_e),be={install(p){p.directive("loading",B),p.config.globalProperties.$loading=F},directive:B,service:F};const ye={__name:"add-edit-dialog",props:{visible:{type:Boolean},visibleModifiers:{},formData:{type:Object},formDataModifiers:{}},emits:["update:visible","update:formData"],setup(p){const m=W(),s=M(),{templates:b}=R(s),i=L(p,"visible"),t=L(p,"formData"),y=async f=>{const o=be.service({lock:!0,text:"Loading",target:document.body,background:"rgba(0, 0, 0, 0.7)"});try{const{data:u}=await X(t.value.projectId,{templateId:f});t.value.params=u}finally{o.close()}},c=j(),C=async()=>{await c.value.validate();for(const f in t.value.params)if(t.value.params[f].name==""||t.value.params[f].value=="")return P.error("参数名和参数值必填");await ie(t.value),i.value=!1,P.success("成功"),m.push("/deploy/index")};return(f,o)=>{const u=ee,n=ae,D=me,h=ue,w=de,q=re,x=le,N=O,A=te;return d(),g(A,{title:"上线项目",modelValue:i.value,"onUpdate:modelValue":o[6]||(o[6]=e=>i.value=e),"close-on-click-modal":!1,width:"50%"},{footer:a(()=>[l(N,{onClick:o[4]||(o[4]=e=>i.value=!1)},{default:a(()=>[V("取 消")]),_:1}),l(N,{type:"primary",onClick:o[5]||(o[5]=e=>C())},{default:a(()=>[V("确 定")]),_:1})]),default:a(()=>[l(x,{ref_key:"elFormRef",ref:c,model:t.value,"label-width":"160px"},{default:a(()=>[l(n,{label:"上线名",rules:{required:!0,trigger:"blur",message:"请输入上线名"},prop:"name"},{default:a(()=>[l(u,{modelValue:t.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value.name=e)},null,8,["modelValue"])]),_:1}),l(n,{label:"项目名"},{default:a(()=>[l(u,{modelValue:t.value.projectName,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value.projectName=e),disabled:""},null,8,["modelValue"])]),_:1}),l(n,{label:"项目描述"},{default:a(()=>[l(u,{modelValue:t.value.projectDesc,"onUpdate:modelValue":o[2]||(o[2]=e=>t.value.projectDesc=e),disabled:""},null,8,["modelValue"])]),_:1}),l(n,{label:"使用模板",rules:{required:!0,trigger:"blur",message:"请输入使用模板"},prop:"templateId"},{default:a(()=>[l(h,{modelValue:t.value.templateId,"onUpdate:modelValue":o[3]||(o[3]=e=>t.value.templateId=e),onChange:y,style:{width:"100%"}},{default:a(()=>[(d(!0),v(I,null,S(_(b),(e,r)=>(d(),g(D,{key:r,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"模板变量"},{default:a(()=>[l(q,{border:"","empty-text":"请先选择使用的模板",style:{"margin-top":"10px"},size:"small",data:t.value.params},{default:a(()=>[l(w,{align:"center",label:"参数名",prop:"name"},{default:a(({row:e})=>[l(u,{modelValue:e.name,"onUpdate:modelValue":r=>e.name=r,disabled:"",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(w,{align:"center",label:"参数值",prop:"desc"},{default:a(({row:e})=>[e.options?(d(),g(h,{key:0,size:"small",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,style:{width:"100%"}},{header:a(()=>[l(u,{placeholder:"自定义",size:"small",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r},null,8,["modelValue","onUpdate:modelValue"])]),default:a(()=>[(d(!0),v(I,null,S(e.options,(r,G)=>(d(),g(D,{key:G,label:r,value:r},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(d(),g(u,{key:1,modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};const ge={class:"project-container"},Ve={class:"my-card-header"},Ee={class:"my-card-body"},ke={__name:"new-deploy",setup(p){const m=M(),{project:s}=R(m),b=j(!1),i=j({}),t=async y=>{i.value={projectId:y.id,templateId:"",projectName:y.name,projectDesc:y.desc},b.value=!0};return(y,c)=>{const C=O,f=ve,o=ne,u=se;return d(),v("div",ge,[l(u,{gutter:20},{default:a(()=>[(d(!0),v(I,null,S(_(s),n=>(d(),g(o,{span:4,key:n.id},{default:a(()=>[l(f,null,{header:a(()=>[$("div",Ve,k(n.name),1)]),footer:a(()=>[l(C,{type:"primary",onClick:D=>t(n),size:"small"},{default:a(()=>[V("部署")]),_:2},1032,["onClick"])]),default:a(()=>[$("div",Ee,k(n.desc),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(ye,{visible:b.value,"onUpdate:visible":c[0]||(c[0]=n=>b.value=n),formData:i.value,"onUpdate:formData":c[1]||(c[1]=n=>i.value=n)},null,8,["visible","formData"])])}}},he=oe(ke,[["__scopeId","data-v-b749554a"]]);export{he as default};
