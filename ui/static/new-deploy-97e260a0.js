import{al as G,aC as K,t as F,Z as Q,c as d,d as g,aa as E,G as b,$ as S,j as y,I as D,T as w,e as j,ab as Y,Y as Z,ak as H,a as J,K as T,a$ as M,L as N,r as z,M as k,g as a,f as l,N as I,O as h,P as L,l as W,m as X,n as R,E as ee,Q as ae,_ as le,b0 as te}from"./index-420c1784.js";import{E as oe,a as se}from"./el-col-b235958a.js";import{a as ne,E as de}from"./el-table-column-bf843040.js";import{E as re,a as ue}from"./el-select-f997ff46.js";import{b as me}from"./api-0da78ac1.js";import{v as P,L as B}from"./directive-5bca586c.js";import"./index-099e5ac8.js";const ie=G({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:K([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),pe=F({name:"ElCard"}),ce=F({...pe,props:ie,setup(f){const u=Q("card");return(s,V)=>(d(),g("div",{class:E([b(u).b(),b(u).is(`${s.shadow}-shadow`)])},[s.$slots.header||s.header?(d(),g("div",{key:0,class:E(b(u).e("header"))},[S(s.$slots,"header",{},()=>[y(D(s.header),1)])],2)):w("v-if",!0),j("div",{class:E([b(u).e("body"),s.bodyClass]),style:Y(s.bodyStyle)},[S(s.$slots,"default")],6),s.$slots.footer||s.footer?(d(),g("div",{key:1,class:E(b(u).e("footer"))},[S(s.$slots,"footer",{},()=>[y(D(s.footer),1)])],2)):w("v-if",!0)],2))}});var fe=Z(ce,[["__file","card.vue"]]);const _e=H(fe),ve={install(f){f.directive("loading",P),f.config.globalProperties.$loading=B},directive:P,service:B};const be={__name:"add-edit-dialog",props:{visible:{type:Boolean},visibleModifiers:{},formData:{type:Object},formDataModifiers:{}},emits:["update:visible","update:formData"],setup(f){const u=J(),s=T(),{templates:V}=M(s),m=N(f,"visible"),t=N(f,"formData"),i=z(),p=async()=>{await i.value.validate();for(const _ in t.value.params)if(t.value.params[_].name==""||t.value.params[_].value=="")return L.error("参数名和参数值必填");await me(t.value),m.value=!1,L.success("成功"),u.push("/deploy/index")};return(_,o)=>{const c=W,v=X,r=ue,$=re,C=R,U=ne,O=de,q=ee,x=ae;return d(),k(x,{title:"上线项目",modelValue:m.value,"onUpdate:modelValue":o[7]||(o[7]=e=>m.value=e),"close-on-click-modal":!1,width:"50%"},{footer:a(()=>[l(C,{onClick:o[5]||(o[5]=e=>m.value=!1)},{default:a(()=>[y("取 消")]),_:1}),l(C,{type:"primary",onClick:o[6]||(o[6]=e=>p())},{default:a(()=>[y("确 定")]),_:1})]),default:a(()=>[l(q,{ref_key:"elFormRef",ref:i,model:t.value,"label-width":"160px"},{default:a(()=>[l(v,{label:"上线名",rules:{required:!0,trigger:"blur",message:"请输入上线名"},prop:"name"},{default:a(()=>[l(c,{modelValue:t.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>t.value.name=e)},null,8,["modelValue"])]),_:1}),l(v,{label:"项目名"},{default:a(()=>[l(c,{modelValue:t.value.projectName,"onUpdate:modelValue":o[1]||(o[1]=e=>t.value.projectName=e),disabled:""},null,8,["modelValue"])]),_:1}),l(v,{label:"项目描述"},{default:a(()=>[l(c,{modelValue:t.value.projectDesc,"onUpdate:modelValue":o[2]||(o[2]=e=>t.value.projectDesc=e),disabled:""},null,8,["modelValue"])]),_:1}),l(v,{label:"使用模板",rules:{required:!0,trigger:"blur",message:"请输入使用模板"},prop:"templateId"},{default:a(()=>[l($,{modelValue:t.value.templateId,"onUpdate:modelValue":o[3]||(o[3]=e=>t.value.templateId=e),style:{width:"100%"}},{default:a(()=>[(d(!0),g(h,null,I(b(V),(e,n)=>(d(),k(r,{key:n,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"模板变量"},{default:a(()=>[l(C,{type:"success",size:"small",onClick:o[4]||(o[4]=e=>t.value.params.push({}))},{default:a(()=>[y("新增")]),_:1}),l(O,{border:"",style:{"margin-top":"10px"},size:"small",data:t.value.params},{default:a(()=>[l(U,{align:"center",label:"参数名",prop:"name"},{default:a(({row:e})=>[l(c,{modelValue:e.name,"onUpdate:modelValue":n=>e.name=n,disabled:e.name=="tag"||e.name=="namespace",size:"small"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),l(U,{align:"center",label:"参数值",prop:"desc"},{default:a(({row:e})=>[e.name=="tag"||e.name=="namespace"?(d(),k($,{key:0,size:"small",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,style:{width:"100%"}},{header:a(()=>[l(c,{placeholder:"自定义",size:"small",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n},null,8,["modelValue","onUpdate:modelValue"])]),default:a(()=>[(d(!0),g(h,null,I(e.options,(n,A)=>(d(),k(r,{key:A,label:n,value:n},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(d(),k(c,{key:1,modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),l(U,{align:"center",width:"170px",label:"操作"},{default:a(({$index:e})=>[l(C,{size:"small",type:"danger",onClick:n=>t.value.params.splice(e,1)},{default:a(()=>[y(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};const ye={class:"project-container"},ge={class:"my-card-header"},Ve={class:"my-card-body"},ke={__name:"new-deploy",setup(f){const u=T(),{project:s}=M(u),V=z(!1),m=z({}),t=async i=>{const p=ve.service({lock:!0,text:"Loading",target:document.body,background:"rgba(0, 0, 0, 0.7)"});m.value={projectId:i.id,templateId:"",projectName:i.name,projectDesc:i.desc};try{const{data:_}=await te(i.id);m.value.params=_,V.value=!0}finally{p.close()}};return(i,p)=>{const _=R,o=_e,c=se,v=oe;return d(),g("div",ye,[l(v,{gutter:20},{default:a(()=>[(d(!0),g(h,null,I(b(s),r=>(d(),k(c,{span:4,key:r.id},{default:a(()=>[l(o,null,{header:a(()=>[j("div",ge,D(r.name),1)]),footer:a(()=>[l(_,{type:"primary",onClick:$=>t(r),size:"small"},{default:a(()=>[y("部署")]),_:2},1032,["onClick"])]),default:a(()=>[j("div",Ve,D(r.desc),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(be,{visible:V.value,"onUpdate:visible":p[0]||(p[0]=r=>V.value=r),formData:m.value,"onUpdate:formData":p[1]||(p[1]=r=>m.value=r)},null,8,["visible","formData"])])}}},ze=le(ke,[["__scopeId","data-v-1f298493"]]);export{ze as default};
